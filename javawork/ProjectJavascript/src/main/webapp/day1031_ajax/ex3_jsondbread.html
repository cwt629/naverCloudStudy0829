<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3. 실습: json db 불러온 게시판</title>
<link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Jua&family=Lobster&family=Nanum+Pen+Script&family=Permanent+Marker&family=Single+Day&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
<style>
    body * {
        font-family: 'Jua';
    }
    
    div.boardicon {
		margin: 30px 100px;
	}
	
	div.boardicon * {
		cursor: pointer;
		margin-right: 30px;
		font-size: 30px;
	}
	
	div.contents {
		margin: 30px 50px;
	}
	
	div.mycard {
		border: 1px solid black;
		border-radius: 5px;
		margin: 20px;
		width: 150px;
		height: 250px;
		float: left;
		padding: 10px;
	}
	
	div.mycard figure img {
		width: 130px;
		height: 130px;
	}
	
	b.cardtitle {
		font-size: 20px;
	}
	
	b.cardwriter {
		font-size: 15px;
		color: #555;
	}
	
	span.listwriter {
		font-size: 10px;
		color: #555;
	}
	
	span.day, span.visit {
		font-size: 10px;
		color: #888;
	}
	
</style>
<script>
	$(function(){
		// 처음 시작 시 그리드 모양 이미지 형태로 출력
		grid();
		$(".boardgrid").css("color", "red");
		
		$(".boardgrid").click(function(){
			$(this).css("color", "red");
			$(".boardlist").css("color", "black");
			grid();			
		});
	
		$(".boardlist").click(function(){
			$(this).css("color", "red");
			$(".boardgrid").css("color", "black");
			list();
		});
	});
	
	function grid()
	{
		$.ajax({
			type: "get",
			dataType: "json",
			url: "simpletojson.jsp",
			success: function(res){
				let s = "";
				$.each(res, function(idx, item){
					// 이미지가 있는 것만 보여주기
					if (item.photo === "none") return;
					
					s += 
					`
					<div class="mycard" style="border: 1px solid black; margin: 20px;">
						<figure>
							<img src="../save/${item.photo}">
							<figcaption>
								<b class="cardtitle">${item.subject}</b>
								<br>
								<b class="cardwriter">${item.writer}</b>
								<br>
								<span class="day">${item.writeday}</span>&nbsp;
								<span class="visit">조회수 ${item.readcount}</span>
							</figcaption>
						</figure>
					</div>
					`;
				})
				
				$(".contents").html(s);
			},
			statusCode: {
				404: function(){
					alert("json 파일을 찾을 수 없다.");
				},
				500: function(){
					alert("서버 오류다. 코드 확인해라.");
				}
			}
		});
	}
	
	function list()
	{
		$.ajax({
			type: "get",
			dataType: "json",
			url: "simpletojson.jsp",
			success: function(res){
				let s = "";
				$.each(res, function(idx, item){
					s += 
					`
					<hr>
					<h4>${item.subject}</h4>
					<p>${item.content}</p>
					<span class="listwriter">${item.writer}</span>&nbsp;
					<span class="day">${item.writeday}</span>&nbsp;
					<span class="visit">조회수 ${item.readcount}</span>
					<br><br>
					`;
				})
				
				$(".contents").html(s);
			},
			statusCode: {
				404: function(){
					alert("json 파일을 찾을 수 없다.");
				},
				500: function(){
					alert("서버 오류다. 코드 확인해라.");
				}
			}
		});
	}
</script>
</head>
<body>
	<div class="boardicon">
		<i class="bi bi-grid boardgrid"></i>
		<i class="bi bi-list boardlist"></i>
	</div>
	
	<div class="contents">
		
	</div>
</body>
</html>